"use strict";const t=require("./is");function e(t,e,i){this.name=t,this.id=e,this.func=i}module.exports=function(){const i=[],s=[],r=(t,e)=>{let s=i.length;for(;s;)if(s-=1,i[s].name===t&&i[s].id===e)return s;return-1};this.register=(s,n,h)=>{const l=s;let o=h,f=n;if(t.func(f))if(t.string(o)){const t=o;o=f,f=t}else o=n,f="all";if(!l)return;const u=r(l,f),c=new e(l,f,o);-1===u?i.push(c):i[u]=c},this.on=this.register,this.subscribe=this.register,this.once=(t,i)=>{if(!t)return;const r=new e(t,"",i);s.push(r)},this.onMany=(t,e)=>{e&&Object.keys(e).forEach((i=>{this.on(i,t,e[i])}))},this.unregister=(t,e)=>{if(!t)return;let n=0;if("all"!==(e||"all"))n=r(t,e),-1!==n&&i.splice(n,1);else{for(n=i.length;n;)n-=1,"all"===i[n].id&&i.splice(n,1);for(n=s.length;n;)n-=1,s[n].name===t&&s.splice(n,1)}},this.off=this.unregister,this.unsubscribe=this.unregister,this.offAll=t=>{let e=i.length;for(;e;)e-=1,i[e].id===t&&i.splice(e,1)},this.trigger=(t,e)=>{const r=(t=>{const e=[];for(let s=0,r=i.length;s<r;s+=1)i[s].name===t&&e.push(i[s]);return e})(t);for(let i=0,s=r.length;i<s;i+=1)r[i].func(e,t);let n=s.length;for(;n;)n-=1,s[n].name===t&&(s[n].func(e,t),s.splice(n,1))},this.emit=this.trigger,this.publish=this.trigger,this.propagate=(t,e)=>{this.trigger(e,t)},this.isRegistered=(t,e)=>{const r=e||"all";let n=i.length;for(;n;)if(n-=1,i[n].id===r&&i[n].name===t)return!0;for(n=s.length;n;)if(n-=1,s[n].name===t)return!0;return!1}};
