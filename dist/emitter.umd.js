!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).emitter=t()}(this,(function(){"use strict";const e={string:function(e){return"string"==typeof e},object:function(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)},array:function(e){return Array.isArray(e)},bool:function(e){return"boolean"==typeof e},number:function(e){return"number"==typeof e},func:function(e){return"function"==typeof e},nul:function(e){return null===e},undef:function(e){return void 0===e||void 0===e}};function t(t,n,r,i){this.name=t,this.namespace=n,this.func=r,this.priority=e.number(i)?i:1}function n(n){this.config={},Object.defineProperty(this.config,"maxListeners",{value:n&&"number"==typeof n.maxListeners?n.maxListeners:50,writable:!1,enumerable:!0}),Object.defineProperty(this.config,"maxOnceListeners",{value:n&&"number"==typeof n.maxOnceListeners?n.maxOnceListeners:50,writable:!1,enumerable:!0});const r=[],i=[],s=e=>r.filter((t=>t.name===e)).length>=this.config.maxListeners,o=e=>i.filter((t=>t.name===e)).length>=this.config.maxListeners,f=(e,t)=>{let n=r.length;for(;n;)if(n-=1,r[n].name===e&&r[n].namespace===t)return n;return-1};this.register=(n,i,o,a)=>{if(!n)return;if(void 0!==a&&!e.number(a))throw new Error("priority must be a number");if(e.func(i))if(e.string(o)){const e=o;o=i,i=e}else e.number(o)&&(a=o),o=i,i="all";const u=f(n,i),l=new t(n,i,o,a);-1===u?s(n)?console.warn(`Max listeners reached for event ${n}`):r.push(l):r[u]=l,r.sort(((e,t)=>e.priority===t.priority?0:e.priority<t.priority?1:-1))},this.on=this.register,this.subscribe=this.register,this.once=(e,n,r)=>{if(!e)return;const s=new t(e,"",n,r);o(e)?console.warn(`Max once listeners reached for event ${e}`):i.push(s),i.sort(((e,t)=>e.priority===t.priority?0:e.priority>t.priority?1:-1))},this.onMany=(e,t)=>{t&&Object.keys(t).forEach((n=>{this.on(n,e,t[n])}))},this.unregister=(e,t)=>{if(!e)return;let n=0;if("all"!==(t=t||"all"))n=f(e,t),-1!==n&&r.splice(n,1);else{for(n=r.length;n;)n-=1,r[n].name===e&&"all"===r[n].namespace&&r.splice(n,1);for(n=i.length;n;)n-=1,i[n].name===e&&i.splice(n,1)}},this.off=this.unregister,this.unsubscribe=this.unregister,this.offAll=e=>{let t=r.length;for(;t;)t-=1,r[t].namespace===e&&r.splice(t,1)};this.trigger=(e,t)=>{const n=(e=>{const t=[];for(let n=0,i=r.length;n<i;n+=1)((r[n].name.indexOf("*")>-1||r[n].name.indexOf("?")>-1)&&new RegExp(r[n].name.replace(/\*/g,".*")).test(e)||r[n].name===e)&&t.push(r[n]);return t})(e);for(let r=0,i=n.length;r<i;r+=1)n[r].func(t,e);((e,t)=>{let n=i.length;for(;n;)n-=1,((i[n].name.indexOf("*")>-1||i[n].name.indexOf("?")>-1)&&new RegExp(i[n].name.replace(/\*/g,".*").replace(/\?/g,".")).test(e)||i[n].name===e)&&(i[n].func(t,e),i.splice(n,1))})(e,t)},this.emit=this.trigger,this.publish=this.trigger,this.propagate=(e,t)=>{this.trigger(t,e)},this.isRegistered=(e,t)=>{t=t||"all";let n=r.length;for(;n;)if(n-=1,r[n].namespace===t&&r[n].name===e)return!0;for(n=i.length;n;)if(n-=1,i[n].name===e)return!0;return!1}}return n.HIGH_PRIORITY=2,n.NORMAL_PRIORITY=1,n.LOW_PRIORITY=0,n}));
